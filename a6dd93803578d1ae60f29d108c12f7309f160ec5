{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7b610306_02c3c89e",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 37,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:08:29Z",
      "side": 1,
      "message": "What does this do now? Looks like the behavior has changed. When an app isn\u0027t installed, we install it? But F-Droid is a system app, so wouldn\u0027t it always be installed?",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fbe4175f_febda4c8",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 37,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-05-16T20:11:51Z",
      "side": 1,
      "message": "The point of this migration is that we\u0027re demoting F-Droid from system app to normal user app. So we only run this migration if F-Droid is not present which means it just got demoted and not if it is already installed (as a user app)",
      "parentUuid": "7b610306_02c3c89e",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6725e1a5_9a0f4636",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 37,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:25:32Z",
      "side": 1,
      "message": "Wait, so you are saying that packageManager.getPackageInfo() will throw an exception if F-Droid is a system app and it won\u0027t when it is a user app?",
      "parentUuid": "fbe4175f_febda4c8",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "670d1dfa_3b298855",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 37,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-05-16T20:29:57Z",
      "side": 1,
      "message": "The exception is thrown if the package name is not found (in this case not installed). If the package is present we don\u0027t want to do anything. If it is not present (in our case, system app was removed from the system images and its data was preserved) we want to install F-Droid which installs it as a user app.",
      "parentUuid": "6725e1a5_9a0f4636",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d7816d94_5ea6ace4",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 37,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:33:37Z",
      "side": 1,
      "message": "Ah thanks for explaining. I was missing the part where the system app would become uninstalled by missing in the system image. Interesting that than the data would still be available for the user app. I imagine this needs some good testing.",
      "parentUuid": "670d1dfa_3b298855",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "60f3ce13_a5a03f59",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:08:29Z",
      "side": 1,
      "message": "Why do we need `applicationContext` two times here?",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45e8db9a_35c52945",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-05-16T20:11:51Z",
      "side": 1,
      "message": "The first is context from CoroutineWorker and the second is the application context of that one.",
      "parentUuid": "60f3ce13_a5a03f59",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0407957d_6c52703c",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:28:28Z",
      "side": 1,
      "message": "I think there\u0027s only a single application context. You might as well do `applicationContext.applicationContext.applicationContext.applicationContext` and so on.",
      "parentUuid": "45e8db9a_35c52945",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a3ee0231_cfebed3c",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-05-16T20:34:15Z",
      "side": 1,
      "message": "What context is SystemAppDemotionWorker receiving?\n\nThis is the first one https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:work/work-runtime/src/main/java/androidx/work/ListenableWorker.java;l\u003d93;drc\u003d187e9a2088c3f281cfb617b9bedd94b9a3546d8b. I\u0027m sending an application context to PackageInstaller since that is what is done in the other class",
      "parentUuid": "0407957d_6c52703c",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "24e0f986_d4ba468b",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2023-05-16T20:36:16Z",
      "side": 1,
      "message": "The docs are all talking about *application* context here, so I\u0027d trust that. Heck, the variable is even called `applicationContext`.",
      "parentUuid": "a3ee0231_cfebed3c",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3516d911_e46c715a",
        "filename": "installer/src/main/java/org/calyxos/lupin/installer/install/BootReceiver.kt",
        "patchSetId": 6
      },
      "lineNbr": 38,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2023-05-16T20:37:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "24e0f986_d4ba468b",
      "revId": "a6dd93803578d1ae60f29d108c12f7309f160ec5",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    }
  ]
}